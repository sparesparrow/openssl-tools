#!/bin/bash
echo "Activating OpenSSL Tools Conan environment..."

# Set Conan environment variables for Python management
export CONAN_PYTHON_ENV="managed"
export CONAN_PYTHON_SOURCE="cache_remote"
export CONAN_USER_HOME="$HOME/projects/openssl-tools/conan-dev"

# Check for Conan-managed Python environment
CONAN_PYTHON_PATH="$HOME/projects/openssl-tools/conan-dev/cache/python"
if [ -d "$CONAN_PYTHON_PATH" ]; then
    echo "Using Conan-managed Python environment..."
    export CONAN_PYTHON_CACHE="$CONAN_PYTHON_PATH"
    export PYTHONPATH="$CONAN_PYTHON_PATH:$HOME/projects/openssl-tools/openssl_tools:$PYTHONPATH"
    export PATH="$CONAN_PYTHON_PATH/bin:$PATH"
    echo "Python source: Conan cache/remote"
    echo "Python cache: $CONAN_PYTHON_CACHE"
else
    echo "Using system Python with Conan environment variables..."
    # Fallback to system Python with Conan environment setup
    source "$HOME/projects/openssl-tools/conan-dev/venv/bin/activate"
    export CONAN_PYTHON_CACHE="$HOME/projects/openssl-tools/conan-dev/cache/python"
    export PYTHONPATH="$HOME/projects/openssl-tools/openssl_tools:$PYTHONPATH"
fi

echo "Environment activated!"
echo "Python: $(which python)"
echo "Conan: conan --version"
echo "Conan Python environment: $CONAN_PYTHON_ENV"
