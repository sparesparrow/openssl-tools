#!/bin/bash
# Conan Development Setup Script

set -e

echo "🚀 Setting up Conan development environment..."

# Check if we're in the right directory
if [ ! -f "conanfile.py" ]; then
    echo "❌ conanfile.py not found. Please run this script from the project root."
    exit 1
fi

# Install Conan if not present
if ! command -v conan &> /dev/null; then
    echo "📦 Installing Conan..."
    pip install conan
else
    echo "✅ Conan already installed"
fi

# Create symlinks for easy access
echo "🔗 Creating symlinks..."
ln -sf "$(pwd)/scripts/conan/conan-install" /usr/local/bin/conan-install 2>/dev/null || true
ln -sf "$(pwd)/scripts/conan/conan-build" /usr/local/bin/conan-build 2>/dev/null || true

# Set up default profile
echo "⚙️ Setting up default profile..."
conan profile detect --force

# Install dependencies
echo "📦 Installing dependencies..."
./scripts/conan/conan-install

echo "✅ Development environment ready!"
echo ""
echo "🎯 Quick commands:"
echo "  conan-install    - Install dependencies"
echo "  conan-build      - Build package"
echo "  conan-install -p linux-clang15  - Use specific profile"
echo "  conan-build -t   - Build and test"
echo ""
echo "📚 For more options, use: conan-install --help or conan-build --help"